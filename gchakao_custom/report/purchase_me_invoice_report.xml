<?xml version='1.0' encoding='utf-8'?>
<odoo>
    <data>
        <template id="external_layout_purchase_me_invoice">
            <div class="header" style="font-size: 12px; font-family: Arial;">
                <div class="container">
                    <div class="row">
                        <div class="col-5">
                            <img t-if="o.company_id.logo" t-att-src="image_data_uri(o.company_id.logo)" style="max-height: 100px; max-width: 200px;" alt="Logo"/>
                        </div>
                        <div class="col-2">
                        
                        </div>
                        <div class="col-5">
                        </div>
                    </div>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-6">
                            <table class="table table-borderless table-sm" style="width: 100%;">
                                <tr>
                                    <td>
                                        <span><b>Proveedor</b>: <t t-esc="o.partner_id.name"/></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <span><b>R.I.F</b>: <t t-esc="o.partner_id.vat"/></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <span><b>Teléfono</b>: <t t-if="o.partner_id.phone" t-esc="o.partner_id.phone"/><t t-elif="o.partner_id.mobile" t-esc="o.partner_id.mobile"/></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <span><b>Dirección</b>: <t t-esc="o.partner_id.street"/> <t t-esc="o.partner_id.city"/> <t t-esc="o.partner_id.state_id.name"/></span>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-6">
                            <table class="table table-borderless table-sm" style="width: 100%;">
                                <tr>
                                    <td>
                                        <b>
                                            Factura N° 
                                            <t t-if="o.move_type=='in_invoice'">
                                                <t t-esc="o.supplier_invoice_number"/>
                                            </t>
                                            <t t-else="">
                                                <t t-esc="o.invoice_number"/>
                                            </t>
                                        </b>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <span><b>Emisión</b> <t t-if="o.invoice_date" t-esc="o.invoice_date.strftime('%d/%m/%Y')"/></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <span><b> Registro</b> <t t-if="o.create_date" t-esc="o.create_date.strftime('%d/%m/%Y')"/></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <span><b> Fecha Contable</b> <t t-if="o.date" t-esc="o.date.strftime('%d/%m/%Y')"/></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <span><b> Vencimiento</b> <t t-if="o.invoice_date_due" t-esc="o.invoice_date_due.strftime('%d/%m/%Y')"/></span> 
                                        <br/>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <span><b>Tasa:</b> <t t-esc="o.tax_today"/></span> 
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <t t-set="bucle" t-value="0"/>
                                        <t t-foreach="o.line_ids.purchase_line_id.order_id" t-as="oc">
                                        <t t-if="bucle == 0">
                                            <span><b>OC: </b><t t-esc="oc.name"/></span><br/>
                                            <t t-set="bucle" t-value="bucle + 1"/>
                                           </t>
                                        </t>         
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="article o_report_layout_standard">
                <t t-raw="0"/>
            </div>

            <div class="footer" style="font-size: 12px; font-family: Arial;">
                <div class="container">
                    <div class="row">
                        <div class="col-6 border border-dark border-bottom-0 p-2">
                            <b>P.M:</b>
                            <t t-esc="o.partner_id.name"/> 
                            
                            <table class="table table-borderless table-sm">
                                <thead>
                                    <th>Banco</th>
                                    <th>Nomero de Cuenta</th>
                                    <th>Documento</th>
                                    <th>Tipo de Cuenta</th>
                                </thead>
                                <t t-foreach="o.partner_id.bank_ids" t-as="bank">
                                    <tr class="text-center">
                                        <td><t t-esc="bank.bank_id.name"/></td>
                                        <td><t t-esc="bank.acc_number"/></td>
                                        <td><t t-esc="bank.doc_identificate"/></td>
                                        <td>
                                            <t t-if="bank.account_type == 'checking'">
                                                Corriente
                                            </t>
                                            <t t-else="">
                                                Ahorro
                                            </t>
                                        </td>
                                    </tr>    
                                </t>
                            </table>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 border border-dark p-2">
                            <b>Notas</b> <br/>
                            <span t-if="o.narration"><t t-esc="o.narration"/><br/></span> <span t-else=""><br/><br/></span>
                        </div>
                        <div class="col-6 border border-dark p-2">
                            <table class="table table-borderless table-sm" style="width: 100%;">
                                 <tr class="text-end">
                                    <td>
                                        <b>Total Exento :</b>
                                    </td>
                                    <td>
                                        <b>$ <t t-esc="o.amount_untaxed_usd" t-options='{"widget": "float", "decimal_precision": "o.company_id.currency_id"}'/></b>
                                    </td>
                                    <td>
                                        <b><t t-esc="o.amount_untaxed_bs" t-options='{"widget": "float", "decimal_precision": "o.company_id.currency_id"}'/> Bs.</b>
                                    </td>
                                </tr>
                                <tr class="text-end">
                                    <td>
                                        <b>Total Base Imponible :</b>
                                    </td>
                                    <t t-if="o.currency_id.id == 3">
                                        <td>
                                            <b>$ <t t-esc="o.amount_total_usd" t-options='{"widget": "float", "decimal_precision": "o.company_id.currency_id"}'/></b>
                                        </td>
                                        <td>
                                            <b><t t-esc="o_amount_total_bs" t-options='{"widget": "float", "decimal_precision": "o.company_id.currency_id"}'/> Bs.</b>
                                        </td>
                                    </t>
                                </tr>
                                <tr class="text-end">
                                    <td>
                                        <b>Impuestos :</b>
                                    </td>
                                    <td>
                                        <b>$ <t t-esc="o.amount_tax_usd" t-options='{"widget": "float", "decimal_precision": "o.company_id.currency_id"}'/></b>
                                    </td>
                                    <td>
                                        <b><t t-esc="o.amount_tax_bs" t-options='{"widget": "float", "decimal_precision": "o.company_id.currency_id"}'/> Bs.</b>
                                    </td>
                                </tr>
                                <tr class="text-end">
                                    <td>
                                        <b>Total: </b>
                                    </td>
                                    <td>
                                        <b>$ <t t-esc="o.amount_total_usd" t-options='{"widget": "float", "decimal_precision": "o.company_id.currency_id"}'/></b>
                                    </td>
                                    <td>
                                        <b><t t-esc="o.amount_total_bs" t-options='{"widget": "float", "decimal_precision": "o.company_id.currency_id"}'/> Bs.</b>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </template>

        <template id="purchase_me_invoice_report">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="gchakao_custom.external_layout_purchase_me_invoice" t-lang="o.partner_id.lang">
                        <div class="page" style="font-size: 11px; font-family: Arial;" >
                            <br/><br/><br/><br/><br/>
                            <table class="table table-borderless table-sm" style="width: 100%;">

                                <!-- Cantidad de columnas -->
                                <colgroup>
                                    <col span="1" style="width: 14%;"/>
                                    <col span="1" style="width: 30%;"/>
                                    <col span="1" style="width: 13%;"/>
                                    <col span="1" style="width: 13%;"/>
                                    <col span="1" style="width: 15%;"/>
                                    <col span="1" style="width: 15%;"/>
                                </colgroup>
                                <!-- Fin Cantidad de columnas -->

                                <!-- Cabeceras -->
                                <thead>
                                    <th class="text-center" style="border-right: 3px solid white; display: table-cell; vertical-align: middle; background-color: #cacaca;">Código</th>
                                    <th class="text-center" style="border-right: 3px solid white; display: table-cell; vertical-align: middle; background-color: #cacaca;">Descripción</th>
                                    <th class="text-center" style="border-right: 3px solid white; display: table-cell; vertical-align: middle; background-color: #cacaca;">Cant.</th>
                                    <th class="text-center" style="border-right: 3px solid white; display: table-cell; vertical-align: middle; background-color: #cacaca;">FillerT.</th>
                                    <th class="text-center" style="border-right: 3px solid white; display: table-cell; vertical-align: middle; background-color: #cacaca;">Costo</th>
                                    <th class="text-center" style="border-right: 3px solid white; display: table-cell; vertical-align: middle; background-color: #cacaca;">Impuesto</th>
                                    <th class="text-center" style="border-right: 3px solid white; display: table-cell; vertical-align: middle; background-color: #cacaca;">Total</th>
                                </thead>
                                <!-- Fin Cabeceras -->
                                
                                <!-- Variables totales -->
                                <t t-set="total_qty" t-value="0"/>
                                <!-- Fin variables totales -->

                                <!-- Lineas -->
                                <tbody>
                                    <t t-foreach="o.invoice_line_ids" t-as="item">
                                        <tr>
                                            <td class="text-center">
                                                <span><t t-esc="item.product_id.default_code"/></span>
                                            </td>
                                            <td class="text-center">
                                                <span><t t-esc="item.name"/></span>
                                            </td>
                                            <td class="text-end">
                                                <span><t t-esc="'%.2f'% item.quantity"/></span>
                                            </td>
                                            <td class="text-end">
                                                <span><t t-esc="item.fillert" t-options='{"widget": "float", "decimal_precision": "o.company_id.currency_secundaria_id"}' /></span>
                                            </td>

                                            <td class="text-end">
                                                <span><t t-esc="item.price_unit_usd" t-options="{'widget': 'monetary', 'display_currency': o.currency_id_dif}"/></span>
                                            </td>
                                            <td class="text-center">
                                                <span><t t-esc=" item.tax_ids.name" /></span>
                                            </td>
                                            <td class="text-end">
                                                <span><t t-esc="item.price_subtotal_usd" t-options="{'widget': 'monetary', 'display_currency': o.currency_id_dif}"/></span>
                                            </td>
                                            <t t-set="total_qty" t-value="total_qty + item.quantity"/>
                                        </tr>
                                    </t>
                                    <tr>
                                        <td colspan="2" class="text-end">Total Cant.</td>
                                        <td class="text-end"><t t-esc="total_qty" t-options='{"widget": "float", "decimal_precision": "o.currency_id"}'/></td>
                                        <td  class="text-end">TotalF: <t t-esc="o.filler_total" t-options='{"widget": "float", "decimal_precision": "o.currency_id"}'/></td>
                                    </tr>
                                </tbody>     
                                <!-- Fin lineas -->
                            </table>
                        </div>
                    </t>
                </t>
            </t>
        </template>
    </data>
</odoo>